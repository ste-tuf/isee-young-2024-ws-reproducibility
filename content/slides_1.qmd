---
title: "Reproducibility in environmental epidemiology"
date: 2024-06-05
author: "St√©phane Tuffier"
format: 
  revealjs:
    chalkboard: true
editor: visual
---


## {background-color="#0b6fa1"}

![](https://imgs.xkcd.com/comics/coronavirus_genome.png)

::: footer
https://xkcd.com/2298
:::

## Reproducibility

Reproducibility

:   Obtain consistent results using the **same data and code** as the original study

Replicability

:   Obtain consistent results **across studies** aimed at answering the same scientific question using **new data** or other new computational methods.

::: footer
@nationalacademiesofsciences2019
:::

:::notes 

Unreplicability can be useful to science and help build knowledge.

-   Domain of study
-   Complex / unknown systems
-   Researchers choices:
    -   **Study design**
    -   **Mistakes**
    -   **Misconduct**
    -   **Poor reporting and publication bias**

Source of not useful non-replication:

-   publication bias

-   misaligned incentives

-   inappropriate statistical inference

-   poor study design

-   errors

-   incomplete reporting of a study
:::

## Reproducibility

Related to computation methods, and analysis: 

- data acquisition, 
- data management, 
- analysis, 
- report of result... 


::: callout-important 
Almost all the steps of an epidemiology study can be involved!
:::

## Reproducibility

![](https://www.science.org/cms/10.1126/science.1213847/asset/f9cbf336-6179-40e1-876d-45f9591423a9/assets/graphic/334_1226_f1.jpeg){fig-alt="reproducibility spectrum" fig-align="center"}

::: footer
@peng2011
:::

## Project organisation

-   Data

    -   Source of the data, last update of the data.

    -   Data storage

-   Analysis

    -   Modifications and corrections applied to the data

    -   Models applied and parameters used

-   Documentation of the data, process and results



## Tools

Open source

:   Software or code that is made freely available for possible modification and **redistribution**.

-   Software

    -   Word vs **Libre Office**,

    -   Stata or SAS vs **R**

    -   Windows vs **Linux**

    -   iOS vs **Android**

## Tools

Why open source matter:

-   Code can be shared or modified easily with version control systems (ex: git)

-   Easy to install the same software and run the same code on another computer (ex: virtual machine)

![](images/branching-illustration@2x.png){fig-align="center" width="321"}

::: footer
@alston2021
:::

## Tools

Beside analysis code and data, manuscripts and papers can also be more reproducible:

-   Collaborative and text based editors (Google Doc, Overleaf...)

-   Insert results directly from the code (RMarkdown, Quarto, gt tables...)

-   Publication on preprint (ArXiv, bioRxiv...)

::: footer
@alston2021
:::

## Check list

![](https://esajournals.onlinelibrary.wiley.com/cms/asset/caa47b00-043b-4b84-92f1-365064758255/bes21801-fig-0001-m.jpg){fig-alt="reproducibility checklist" fig-align="center"}

::: footer
@alston2021
:::


- Welcome
  - Importance of reproducibility in epidemiology research
  - The principles of a reproducible workflow
      - Creating and organizing a project structure for reproducibility
      - Avoiding copy pasting with functions
      - Git basic to keep track your code
  - Real-world examples

## Group work 2 - 20 min {.smaller}

Objective: to repeat the previous analysis using a tool based on R (Radiant).

-   Answer the same questions:

    1.  What is the average levels of PM2.5 and O3?
    2.  How many countries have high levels of PM2.5 and O3?
    3.  What is the average life expectancy lost because of air pollution in countries with high levels of of PM2.5 and O3?

## Group work 2 - 20 min {.smaller}

::: columns
::: {.column width="50%"}
-   Open the website:\
    <https://ste-tuf.shinyapps.io/radiant-hrm/>\
    (alt: <https://vnijs.shinyapps.io/radiant>)

-   Load `world_air_pollution.csv`

-   Add the operation to the report by clicking on this button:

    ![](images/button_save.png)
:::

::: {.column width="50%"}
![](images/load_data.png){fig-align="center" width="251"}
:::
:::

## Group work 2 - 20 min {.smaller}

::: columns
::: {.column width="50%"}
-   In `Data > Transform`:

    -   Change columns with Transformation type `Recode`:

        -   `"Country1" = "region"; "country2" = "region"; else = "other_regions2"`

        <!-- -->

        -   `lo:30 = "low"; else = "high"`

    -   Filter row using `Filter data > Data filter` : `variable == "low"`

-   Calculate means or sums in `Basic > Means / Proportions`

-   Try some graphs to visualize you data `Data > Visualize`
:::

::: {.column width="50%"}
![](images/transform_data.png){fig-align="center" width="188"}
:::
:::

## Debrief - 15 min




## To go further {.smaller .scrollable}

-   Papers:
    -   "Reproducibility Project: Cancer Biology", @scienceReproducibilityProjectCancer
    -   "Is science really facing a reproducibility crisis, and do we need it to?", @fanelli2018
-   Tools:
    -   R:
        -   https://cran.r-project.org/
        -   https://posit.co/products/open-source/
    -   Git: https://ohmygit.org/, https://happygitwithr.com/
-   Related course:
    -   [Reproducible Research in R](https://r-cubed-intro.rostools.org/sessions/introduction.html)

    -   [Harvard Free Courses - Reproducible research](https://pll.harvard.edu/course/principles-statistical-and-computational-tools-reproducible-data-science)

## References {.smaller}
